
### 概述

执行引擎是Java虚拟机核心的组成部分之一，虚拟机是一个相对于物理机的概念，这两种机器都有代码执行的能力，其区别是物理机的执行引擎是直接建立在处理器、缓存、指令集合操作系统层面上的，而虚拟机的执行引擎是由软件自行实现的，因此可以不受物理条件制约地定制指令集与执行引擎的结构体系，能够执行那些不被硬件支持的指令集格式。

在不同的虚拟机实现中，执行引擎在执行字节码的时候，通常会有解释执行（通过解释器执行）和编译执行（通过即时编译器产生本地代码执行）两种选择，也可能两者兼备。

### 运行时栈帧结构

**Java虚拟机以方法作为基本的执行单元，栈帧则是用于支持虚拟机进行方法调用和方法执行背后的数据结构，它也是虚拟机运行时数据区中的虚拟机栈的栈元素。栈帧存储了方法的局部变量表、操作数栈、动态连接和方法返回地址等信息。每个方法从调用开始至执行结束的过程，都对应着一个栈帧在虚拟机里面从入栈到出栈的过程**。

在编译Java程序源码的时候，栈帧中需要多大的局部变量表，需要多深的操作数栈就已经被分析计算出来，并且写入到方法表的Code属性之中。一个栈帧需要分配多少内存，并不会受到程序运行期变量数据的影响，而仅仅取决于程序源码和具体的虚拟机实现的栈内存布局形式。

对于执行引擎来讲，在活动线程中，只有位于栈顶的方法才是在运行的，只有位于栈顶的栈帧才是生效的，其被称为当前栈帧，与这个栈帧所关联的方法被称为当前方法。执行引擎所允许的所有字节码指令都只针对当前栈帧进行操作，在概念模型上，典型的栈帧结果如图：

![](https://raw.githubusercontent.com/xfhy/Android-Notes/master/Images/%E6%A0%88%E5%B8%A7%E7%9A%84%E6%A6%82%E5%BF%B5%E7%BB%93%E6%9E%84.png)

#### 局部变量表

#### 操作数栈

#### 动态连接

#### 方法返回地址

#### 附加信息

### 方法调用

### 动态类型语言支持

### 基于栈的字节码解释执行引擎
